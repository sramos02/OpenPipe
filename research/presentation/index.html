<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>OpenPipe</title>

		<meta name="description" content="Implementation and Analysis of a Web Request Pipelining Framework">
		<meta name="author" content="Sean Kenny">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<link rel="stylesheet" href="css/reveal.min.css">
		<link rel="stylesheet" href="css/theme/default.css" id="theme">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">
		<link rel="stylesheet" href="lib/css/pdf.css">

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">

				<section>
					<h1>OpenPipe</h1>
					<h3>
						Implementation and Analysis of a<br /> 
						Web Request Pipelining Framework
					</h3>
					<p>
						<small>Created by <a href="http://www.polycoder.net">Sean Kenny</a> / <a href="http://twitter.com/polycoder">@polycoder</a></small>
					</p>
				</section>

				<section>
					 <h2 class>Before I forget...</h2>
					 <h1 class="fragment" >Thanks for coming!</h1>
				</section>

				<section>
					 <h2>Who's this guy?</h2>
				</section>

				<section>
					<h2>What are we trying to solve?</h2>
					<p>
						Increase, 'perceived', speed of web pages served via traditional HTTP web servers
					</p>
				</section>


				<section>
					<h2>How the magic happens.</h2>
					<a class="image" href="http://lab.hakim.se/meny/" target="_blank">
						<img src="images/http_request_cycles.jpg" alt="Meny">
					</a>
				</section>

				<!-- Example of nested vertical slides -->
				<section>
					<section>
						<h2>Tools of the Trade</h2>
						<p>
							OpenPipe utilizes a set of applications and tools for operation and testing
						</p>
					</section>
					<section>
						<h2>PHP</h2>
						<img src="images/php_logo.png" />
						<p>The core server components of OpenPipe were all written with PHP 5.3. PHP is a general-purpose server-side scripting language originally designed for web development to produce dynamic web pages.</p>
					</section>
					<section>
						<h2>CodeIgniter</h2>
						<img src="images/ci_logo.jpg" />
						<p>The OpenPipe library that has currently been developed provides an adapter that interfaces with the CodeIgniter framework.</p>
					</section>
					<section>
						<h2>Apache</h2>
						<img src="images/apache_logo.png" />
						<p>OpenPipe has been built and tested using the Apache HTTP server. OpenPipe is not limited to running on this architecture, and can theoretically be run on any web server that supplies integration with PHP.</p>
					</section>
					<section>
						<h2>FireFox</h2>
						<img src="images/firefox_logo.png" />
						<p>All client side testing and analysis (manual and automated) of OpenPipe was per- formed using the FireFox web browser.</p>
					</section>
					<section>
						<h2>Selenium</h2>
						<img src="images/selenium_logo.png" />
						<p>Selenium automates browsers by providing a common API that is provided in the form of a, ’WebDriver’</p>
					</section>
				</section>

				<section>
					<h2>Client-server model</h2>
					<p>A pipeline HTTP approach represented a traditional client-server communication process.</p>
					<img height="400" src="images/pipeline_request_cycle.png" />
				</section>

				<section>
					<h2>Server components</h2>
					<img height="500" src="images/framework_stack.png" />
				</section>

				<section>
					<h2>Client components</h2>
					<img height="500" src="images/client_stack.png" />
				</section>

				<section>
					<h2>Pipelet</h2>
					<p>Every OpenPipe HTTP request cycle is composed of pipelets. A pipelets represents an atomic composition of HTML, CSS, and JavaScript. A web page request can be composed of one to many pipelets.</p>
					<pre><code contenteditable>
&lt;!-- a simple pipelet containing css , javascript , and html --&gt;
&lt;div pipelet-id="pipelet-1" &gt;
	&lt;link 
		rel="stylesheet" 
		type="text/css" 
		href="css/pipelet-1.css" 
	/&gt;
	&lt;script type="text/javascript" src="js/pipelet-1.js" &gt;
	&lt/script&gt; 
	&lt;h1>Hello world!&lt/h1&gt;
&lt;/div&gt;
					</code></pre>
				</section>


				<section>
					<h2>Root Pipelet</h2>
					<p>Every pipelined HTTP request contains at least one initial pipelet. This pipelet determines the initial layout.</p>
					<pre><code contenteditable>
&lt;!-- Root pipelet html code --&gt;						
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Root Pipelet!&lt;/title&gt;
&lt;link rel="stylesheet" type="text/css" href="css/global.css" /&gt; 
&lt;script type="text/javascript" src="js/app.js" &gt;&lt;/script&gt; 
&lt;/head&gt;
&lt;body&gt;
	&lt;h1&gt;Hello World!&lt;/h1&gt;
	&lt;div pipelet-id="pipelet-1"&gt;&lt;/div&gt;
	&lt;div pipelet-id="pipelet-2"&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
					</pre></code>
				</section>

				<section>
					<img  height="575" src="images/root_pipelet.png" />
				</section>

				<section>
					<h2>Nested Pipelets</h2>
					<p>
						Pipelets can be nested within other pipelets. Pipletes are loaded breadth first. This allows for:
					</p>
					<ul>
						<li>mechanism to display content that contains n-levels of content depth</li>
						<li>page being rendered can start to be divided into subcomponents</li>
						<li>subcomponents can have more subcomponents of their own.</li>
					<ul>
				</section>

				<section>
					<img height="575" src="images/nested_pipelets.png" />
				</section>


				<section>
					<h2>Pipelet Priority</h2>
					<p>Pipelets that are part of the same depth can prioritized explicitly using the pipelet-priority OpenPipe HTML attribute</p>
					<pre><code>
&lt;!-- a root pipelet --&gt; 
&lt;html&gt;
&lt;head&gt;
	&lt;title&gt;Root Pipelet!&lt;/title&gt;
	&lt;link rel="stylesheet" type="text/css" href="css/global.css" /&gt;
	&lt;script type="text/javascript" src="js/app.js" &gt;&lt;/script&gt; 
&lt;/head&gt;
&lt;body&gt;
	&lt;h1&gt;Hello World!&lt;/h1&gt;
	&lt;div pipelet-id="pipelet-1"&gt;&lt;/div&gt;
	&lt;div pipelet-id="pipelet-2" pipelet-priority="1" &gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
				</code></pre>
				</section>


				<section>
					<section>
						<h2>Class Interfaces</h2>
						<p>OpenPipe defines core interfaces for pluggable components of the system. Through utilizing provided interfaces developers can contour and extend the library to meet new and existing needs.</p>
					</section>

					<section>
						<h2>Output</h2>
						<img height="500" src="images/generalization_output.png" />
					</section>

					<section>
						<h2>Framework Adapter</h2>
						<img height="500" src="images/generalization_adapters.png" />
					</section>
				</section>



				<section>
					<section>
						<h2>Design Patterns</h2>
						<p>The OpenPipe library utilizes design patterns where appropriate to make the available components easier to comprehend from a conceptial level, and also easier to extend for future use. The patterns explained below were chosen to provide maximum flexibility to the underlying system when integrating with existing PHP web application systems and frameworks.</p>
					</section>

					<section>
						<h2>OpenPipe_Runner - Strategy</h2>
						<img height="500" src="images/strategy_runner.png" />
					</section>

					<section>
						<h2>Pipelet Factory</h2>
						<img height="400" src="images/factory_pipelets.png" />
					</section>
				</section>


				<section>
					<section>
						<h2>Sequence Diagrams</h2>
					</section>

					<section>
						<h2>Server Sequence Diagram</h2>
						<img height="500" src="images/openpipe_runner.png" />
					</section>

					<section>
						<h2>Client Sequence Diagram</h2>
						<img height="500" src="images/openpipe_clientoutput.png" />
					</section>
				</section>

				<section>
					<h2>Data Transmitted</h2>
					<p>Pipelet data is transmitted as JSON to the client. Each individual pipelet transmitted as JSON is referred to as a segment in the OpenPipe.js client library. Everything transmitted from the server to client is sent as a segment.</p>
					<img height="200" src="images/client_segment_data_object.png" />
				</section>

				<section>
					<section>
						<h2>Testing Methodology</h2>
					</section>

					<section>
						<h2>Create Static Sample App</h2>
						<img height="500" src="images/sample_app.jpg" />
					</section>

					<section>
						<h2>Create Basic Prototype</h2>
						<a href="http://localhost/dev/openpipe/example/basic/" >
							<img height="500" src="images/basic_pipeline.jpg" />
						</a>
					</section>

					<section>
						<h2>Create MVC Pipeline Adapter</h2>
						<p>Implement an adapter for a PHP MVC framework, using the adapter strategy. An adapter was made for CodeIgniter.
<pre><code contenteditable>
$openPipeAdapter = new OpenPipe_Adapter_Pvc_CodeIgniter(dirname(__FILE__));

if(isset($_GET['nopipe'])){
	$openPipeOutput = new OpenPipe_Output_Standard();	
}else{
	$openPipeOutput = new OpenPipe_Output_Piped('../../../../client/js');	
}

$openPipeRunner = new OpenPipe_Runner($openPipeAdapter, $openPipeOutput);	
$openPipeRunner->run();
</code></pre>
					</section>

					<section>
						<h2>Automate Data Collection</h2>
						<p>Selenium was a perfect candidate for automated retrieval of data from window.performance.timing </p>
						<pre><code contenteditable>
interface PerformanceTiming { 
	long long navigationStart; 
	long long unloadEventStart; 
	long long unloadEventEnd; 
	long long redirectStart; 
	long long redirectEnd;
	long long fetchStart;
	long long domainLookupStart;
	long long domainLookupEnd;
	long long connectStart;
	long long connectEnd;
	long long secureConnectionStart;
	long long requestStart;
	long long responseStart;
	long long responseEnd;
	long long domLoading;
	long long domInteractive;
	long long domContentLoadedEventStart; long long domContentLoadedEventEnd; long long domComplete;
	long long loadEventStart;
	long long loadEventEnd;
};
						</code></pre>
					</section>

					<section>
						<img src="images/timing_overview.png" />

						<aside class="notes" >	
							to run: cat urls | xargs -L1 ruby performance.rb
						</aside>
					</section>

					<section>
						<h2>Simulating Load</h2>
						<p>To achieve an accurate simulation of load the freely available and opensource tool named, ’Siege’, was utilized.</p>
						<p>OpenPipe was tested while siege was run at concurrency levels 10, 25, 50, and 100.</p>

						<aside class="notes" >	
							to run: cat urls | xargs -L1 ruby performance.rb
						</aside>
					</section>

				</section>



				<section>
					<section>
						<h2>Results</h2>
					</section>

					<section>
						<h2>Data Table</h2>
						<img  height="500" src="images/results_table.png" />
						<aside class="notes" >
							<pre>
1. Type - Represents the type of external event that the server is issuing to complete the given web page request. Three types of web page requests were simulated:
	(a) Plain HTML - The server does not connect to any external system. It simply renders and return HTML content. This HTML content also includes CSS and JavaScript.
	(b) Database - The server creates a connection to a local database system and issues select queries over this connection to gather data. The data is not used in the display of the web page, but nevertheless this simulates the overhead necessary to connect to a local database system, loop through the data, and return a result.
	(c) Web Service - The server create a connection to an external REST based web service. For the purposes of these tests the server connect to the twitter REST API and issues REST based query commands.
2. Load - The ammount of load that is being put on the web server during the testing time. Load was simulated using the command line tool named, ’Siege’. The number presented in this column represents the total number of concurrent connection being issued from Siege during the tests.
3. Response - The initial response time for a non piped page. The formula for this data point is: responseStart 
							</pre>
						</aside>
					</section>

					<section>
						<h2>Plain HTML Results</h1>
						<img height="500" src="images/analysis_chart_plain.png" />
					</section>


					<section>
						<h2>Database Results</h1>
						<img height="500" src="images/analysis_chart_database.png" />
					</section>

					<section>
						<h2>Web Service Results</h1>
						<img height="500" src="images/analysis_chart_webservice.png" />
					</section>

					<section>
						<h2>Conclusions</h2>
						<ul>
							<li>On average across all type of requests and server load a piped request requires only 38% of the time that would be needed to send a non-piped version of the same page.</li>
							<li>Requests that involve calls to external web services see the biggest performance gains.</li>
							<li>Piped versions of pages do. on average, require more time to load.</li>
							<li>Overall load on the server caused the greatest increase in response time when sending database type requests.</li>
						</ul>
					</section>
				</section>

				<section>
					<h2>I get it! Lets see this in action!!</h2>
					<p>Demo time</p>

					<aside class="notes">
						<ul>
							<li>Demo Items</li>
							<li>Show Source Code</li>
						</ul>
					</aside>
				</section>


				<section>
					<h2>Common Reactions</h2>
					<ul>
						<li>Wait? Can't I do this with AJAX?!</li>
						<li>But what about SEO? That piped data didn't look web crawler friendly...</li>
					</ul>

					<aside class="notes" >
						<ul>
							<li>
								AJAX - SURE CAN. But this is gonna mean more opening/closing of connections (overhead)
							</li>
							<li>
								Great observation! Need to check agent and use the proper adapter to output nopipe=true version (demo nopipe=true).
							</li>
						</ul>
					</aside>
				</section>

				<section>
					<h2>Future Work</h2>
					<ul>
						<li>Expanded Output API</li>
						<li >Enhanced Minification</li>
						<li >Addition of framework adapters</li>
						<li >Language agnostic Apache server extension</li>
					</ul>
				</section>

				<section>
					<h2>OpenPipe Resources</h2>
					<ul>
						<li ><a target="_blank" href="http://www.open-pipe.com">open-pipe.com</a></li>
						<li ><a target="_blank"  href="https://github.com/polycoder/OpenPipe">source code via GitHub (fork me!)</a></li>
						<li ><a target="_blank"  href="http://localhost/dev/openpipe/docs/server/">class documentation (in source code)</a></li>
					</ul>
				</section>


				<section>
					<h1>THE END</h1>
					<h3>BY Sean Kenny / polycoder.net</h3>
				</section>

			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.min.js"></script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/none

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/showdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
					// { src: 'plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

		</script>

	</body>
</html>
